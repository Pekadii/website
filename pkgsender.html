<!DOCTYPE html>
<html>
<head>
  <title>PS4 PKG Sender</title>
  <style>
    body { background: #111; color: white; font-family: sans-serif; text-align: center; padding-top: 50px; }
    input, button { padding: 10px; margin: 10px; width: 300px; }
    #dropZone { border: 2px dashed #aaa; padding: 30px; margin: 20px auto; width: 80%; max-width: 600px; }
  </style>
</head>
<body>
  <h1>ðŸ“¦ PS4 PKG Sender</h1>

  <div id="dropZone">Drag & drop your .pkg file here</div>

  <input type="text" id="ps4ip" placeholder="Enter PS4 IP (e.g., 192.168.0.125)">
  <input type="text" id="pkgurl" placeholder="PKG URL will appear here" readonly>
  <br>
  <button onclick="sendToPS4()">Send to PS4</button>

  <script>
    const dropZone = document.getElementById('dropZone');
    const pkgurl = document.getElementById('pkgurl');

    dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.style.borderColor = 'lime'; });
    dropZone.addEventListener('dragleave', () => dropZone.style.borderColor = '#aaa');
    dropZone.addEventListener('drop', async e => {
      e.preventDefault();
      dropZone.style.borderColor = '#aaa';

      const file = e.dataTransfer.files[0];
      if (!file.name.endsWith('.pkg')) return alert('Only .pkg files allowed!');

      const formData = new FormData();
      formData.append('file', file);

      const res = await fetch('upload.php', { method: 'POST', body: formData });
      const result = await res.text();
      pkgurl.value = result;
    });

    function sendToPS4() {
      const ip = document.getElementById('ps4ip').value.trim();
      if (!ip || !pkgurl.value) return alert('Missing IP or PKG URL');

      fetch(`http://${ip}:12800/api/install`, {
        method: 'POST',
        body: JSON.stringify({ type: "direct", url: pkgurl.value }),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => {
        if (res.ok) alert("Sent to PS4 successfully!");
        else throw new Error();
      })
      .catch(() => alert("Failed to send to PS4! Make sure GoldHEN Remote PKG Installer is running."));
    }
  </script>
</body>
</html>
